Io=imread('cameraman.tif');
I=double(Io);
wname='sym8';
dwtmode('per');
%%小波分解
[I11 IH1 IV1 ID1]=dwt2(I,wname);
[I21 IH2 IV2 ID2]=dwt2(I11,wname);
[I31 IH3 IV3 ID3]=dwt2(I21,wname);
window=[7 7];
Opname='std2';
%%计算方差
sigmI11=nlfilter(I11,window,Opname);
sigmIH1=nlfilter(IH1,window,Opname);
sigmIV1=nlfilter(IV1,window,Opname);
sigmID1=nlfilter(ID1,window,Opname);
sigmI21=nlfilter(I21,window,Opname);
sigmIH2=nlfilter(IH2,window,Opname);
sigmIV2=nlfilter(IV2,window,Opname);
sigmID2=nlfilter(ID2,window,Opname);
sigmI31=nlfilter(I31,window,Opname);
sigmIH3=nlfilter(IH3,window,Opname);
sigmIV3=nlfilter(IV3,window,Opname);
sigmID3=nlfilter(ID3,window,Opname);
%%均值
Opname='mean2';
meanI11=nlfilter(I11,window,Opname);
meanIH1=nlfilter(IH1,window,Opname);
meanIV1=nlfilter(IV1,window,Opname);
meanID1=nlfilter(ID1,window,Opname);

meanI21=nlfilter(I21,window,Opname);
meanIH2=nlfilter(IH2,window,Opname);
meanIV2=nlfilter(IV2,window,Opname);
meanID2=nlfilter(ID2,window,Opname);

meanI31=nlfilter(I31,window,Opname);
meanIH3=nlfilter(IH3,window,Opname);
meanIV3=nlfilter(IV3,window,Opname);
meanID3=nlfilter(ID3,window,Opname);
IsI11=I11./(sigmI11+.1^10);
IsIH1=IH1./(sigmIH1+.1^10);
IsIV1=IV1./(sigmIV1+.1^10);
IsID1=ID1./(sigmID1+.1^10);

IsI21=I21./(sigmI21+.1^10);
IsIH2=IH2./(sigmIH2+.1^10);
IsIV2=IV2./(sigmIV2+.1^10);
IsID2=ID2./(sigmID2+.1^10);

IsI31=I31./(sigmI31+.1^10);
IsIH3=IH3./(sigmIH3+.1^10);
IsIV3=IV3./(sigmIV3+.1^10);
IsID3=ID3./(sigmID3+.1^10);
S1=size(IsI11);
Iss1=reshape(IsI11,S1(1)*S1(2),1);
Iss2=reshape(IsIH1,S1(1)*S1(2),1);
Iss3=reshape(IsIV1,S1(1)*S1(2),1);
Iss4=reshape(IsID1,S1(1)*S1(2),1);
S2=size(IsI21);
Iss21=reshape(IsI21,S2(1)*S2(2),1);
Iss22=reshape(IsIH2,S2(1)*S2(2),1);
Iss23=reshape(IsIV2,S2(1)*S2(2),1);
Iss24=reshape(IsID2,S2(1)*S2(2),1);
S3=size(IsI31);
Iss31=reshape(IsI31,S3(1)*S3(2),1);
Iss32=reshape(IsIH3,S3(1)*S3(2),1);
Iss33=reshape(IsIV3,S3(1)*S3(2),1);
Iss34=reshape(IsID3,S3(1)*S3(2),1);
%%显示分布图
figure(1);
histfit(Iss1);
title('(a) 尺度为1时低频系数分布');
figure(2);
histfit(Iss2);
title('(b) 尺度为1时水平高频系数分布');
figure(3);
histfit(Iss3);
title('(c) 尺度为1时垂直高频系数分布');
figure(4);
histfit(Iss4);
title('(d) 尺度为1时对角高频系数分布');
figure(5);
histfit(Iss21);
title('(e) 尺度为2时低频系数分布');
figure(6);
histfit(Iss22);
title('(f) 尺度为2时水平高频系数分布');
figure(7);
histfit(Iss23);
title('(g) 尺度为2时垂直高频系数分布');
figure(8);
histfit(Iss24);
title('(h) 尺度为2时对角高频直方图');
figure(9);
histfit(Iss31);
title('(i) 尺度为3时低频系数分布');
figure(10);
histfit(Iss32);
title('(j) 尺度为3时水平高频系数分布');
figure(11);
histfit(Iss33);
title('(k) 尺度为3时垂直高频系数分布');
figure(12);
histfit(Iss34);
title('(l) 尺度为3时对角高频系数分布');
