%t=0.001:0.001:1; 
t=1:1000; 
s1=sin(2*pi*50*t*0.001)+sin(2*pi*120*t*0.001)+rand(1,length(t)); 

for t=1:500; 
s2(t)=sin(2*pi*50*t*0.001)+sin(2*pi*120*t*0.001)+rand(1,length(t)); 
end 

for t=501:1000; 
s2(t)=sin(2*pi*200*t*0.001)+sin(2*pi*120*t*0.001)+rand(1,length(t)); 
end 

subplot(9,2,1) 
plot(s1) 
title('原始信号') 
ylabel('S1') 

subplot(9,2,2) 
plot(s2) 
title('故障信号') 
ylabel('S2') 

wpt=wpdec(s1,3,'db1','shannon'); 

%plot(wpt); 
s130=wprcoef(wpt,[3,0]); 
s131=wprcoef(wpt,[3,1]); 
s132=wprcoef(wpt,[3,2]); 
s133=wprcoef(wpt,[3,3]); 
s134=wprcoef(wpt,[3,4]); 
s135=wprcoef(wpt,[3,5]); 
s136=wprcoef(wpt,[3,6]); 
s137=wprcoef(wpt,[3,7]); 
s10=norm(s130); 
s11=norm(s131); 
s12=norm(s132); 
s13=norm(s133); 
s14=norm(s134); 
s15=norm(s135); 
s16=norm(s136); 
s17=norm(s137); 

st10=std(s130); 
st11=std(s131); 
st12=std(s132); 
st13=std(s133); 
st14=std(s134); 
st15=std(s135); 
st16=std(s136); 
st17=std(s137); 

disp('正常信号的特征向量'); 
snorm1=[s10,s11,s12,s13,s14,s15,s16,s17] 
std1=[st10,st11,st12,st13,st14,st15,st16,st17] 

subplot(9,2,3);plot(s130); 
ylabel('S130'); 
subplot(9,2,5);plot(s131); 
ylabel('S131'); 
subplot(9,2,7);plot(s132); 
ylabel('S132'); 
subplot(9,2,9);plot(s133); 
ylabel('S133'); 
subplot(9,2,11);plot(s134); 
ylabel('S134'); 
subplot(9,2,13);plot(s135); 
ylabel('S135'); 
subplot(9,2,15);plot(s136); 
ylabel('S136'); 
subplot(9,2,17);plot(s137); 
ylabel('S137'); 

wpt=wpdec(s2,3,'db1','shannon'); 

%plot(wpt); 
s230=wprcoef(wpt,[3,0]); 
s231=wprcoef(wpt,[3,1]); 
s232=wprcoef(wpt,[3,2]); 
s233=wprcoef(wpt,[3,3]); 
s234=wprcoef(wpt,[3,4]); 
s235=wprcoef(wpt,[3,5]); 
s236=wprcoef(wpt,[3,6]); 
s237=wprcoef(wpt,[3,7]); 

s20=norm(s230); 
s21=norm(s231); 
s22=norm(s232); 
s23=norm(s233); 
s24=norm(s234); 
s25=norm(s235); 
s26=norm(s236); 
s27=norm(s237); 

st20=std(s230); 
st21=std(s231); 
st22=std(s232); 
st23=std(s233); 
st24=std(s234); 
st25=std(s235); 
st26=std(s236); 
st27=std(s237); 

disp('故障信号的特征向量'); 
snorm2=[s20,s21,s22,s23,s24,s25,s26,s27] 
std2=[st20,st21,st22,st23,st24,st25,st26,st27] 

subplot(9,2,4);plot(s230); 
ylabel('S230'); 
subplot(9,2,6);plot(s231); 
ylabel('S231'); 
subplot(9,2,8);plot(s232); 
ylabel('S232'); 
subplot(9,2,10);plot(s233); 
ylabel('S233'); 
subplot(9,2,12);plot(s234); 
ylabel('S234'); 
subplot(9,2,14);plot(s235); 
ylabel('S235'); 
subplot(9,2,16);plot(s236); 
ylabel('S236'); 
subplot(9,2,18);plot(s237); 
ylabel('S237'); 

%fft 
figure 
y1=fft(s1,1024); 
py1=y1.*conj(y1)/1024; 
y2=fft(s2,1024); 
py2=y2.*conj(y2)/1024; 

y130=fft(s130,1024); 
py130=y130.*conj(y130)/1024; 
y131=fft(s131,1024); 
py131=y131.*conj(y131)/1024; 
y132=fft(s132,1024); 
py132=y132.*conj(y132)/1024; 
y133=fft(s133,1024); 
py133=y133.*conj(y133)/1024; 
y134=fft(s134,1024); 
py134=y134.*conj(y134)/1024; 
y135=fft(s135,1024); 
py135=y135.*conj(y135)/1024; 
y136=fft(s136,1024); 
py136=y136.*conj(y136)/1024; 
y137=fft(s137,1024); 
py137=y137.*conj(y137)/1024; 

y230=fft(s230,1024); 
py230=y230.*conj(y230)/1024; 
y231=fft(s231,1024); 
py231=y231.*conj(y231)/1024; 
y232=fft(s232,1024); 
py232=y232.*conj(y232)/1024; 
y233=fft(s233,1024); 
py233=y233.*conj(y233)/1024; 
y234=fft(s234,1024); 
py234=y234.*conj(y234)/1024; 
y235=fft(s235,1024); 
py235=y235.*conj(y235)/1024; 
y236=fft(s236,1024); 
py236=y236.*conj(y236)/1024; 
y237=fft(s237,1024); 
py237=y237.*conj(y237)/1024; 

f=1000*(0:511)/1024; 
subplot(1,2,1); 
plot(f,py1(1:512)); 
ylabel('P1'); 
title('原始信号的功率谱') 
subplot(1,2,2); 
plot(f,py2(1:512)); 
ylabel('P2'); 
title('故障信号的功率谱') 
figure 
subplot(4,2,1); 
plot(f,py130(1:512)); 
ylabel('P130'); 
title('S130的功率谱') 
subplot(4,2,2); 
plot(f,py131(1:512)); 
ylabel('P131'); 
title('S131的功率谱') 
subplot(4,2,3); 
plot(f,py132(1:512)); 
ylabel('P132'); 
subplot(4,2,4); 
plot(f,py133(1:512)); 
ylabel('P133'); 
subplot(4,2,5); 
plot(f,py134(1:512)); 
ylabel('P134'); 
subplot(4,2,6); 
plot(f,py135(1:512)); 
ylabel('P135'); 
subplot(4,2,7); 
plot(f,py136(1:512)); 
ylabel('P136'); 
subplot(4,2,8); 
plot(f,py137(1:512)); 
ylabel('P137'); 

figure 
subplot(4,2,1); 
plot(f,py230(1:512)); 
ylabel('P230'); 
title('S230的功率谱') 
subplot(4,2,2); 
plot(f,py231(1:512)); 
ylabel('P231'); 
title('S231的功率谱') 
subplot(4,2,3); 
plot(f,py232(1:512)); 
ylabel('P232'); 
subplot(4,2,4); 
plot(f,py233(1:512)); 
ylabel('P233'); 
subplot(4,2,5); 
plot(f,py234(1:512)); 
ylabel('P234'); 
subplot(4,2,6); 
plot(f,py235(1:512)); 
ylabel('P235'); 
subplot(4,2,7); 
plot(f,py236(1:512)); 
ylabel('P236'); 
subplot(4,2,8); 
plot(f,py237(1:512)); 
ylabel('P237'); 
figure 
%plottree(wpt)
